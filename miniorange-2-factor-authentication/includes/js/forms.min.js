const activeTab=localStorage.getItem("activeTab")||"mo2f_login_btn";function switchTab(e){localStorage.setItem("activeTab",e);const o=jQuery("#mo2f_login_form_settings"),s=jQuery("#mo2f_registration_form_settings"),t=jQuery("#mo2f_login_btn"),r=jQuery("#mo2f_register_button");"mo2f_login_btn"===e?(o.removeClass("hidden"),s.addClass("hidden"),t.addClass("mo2f-active"),r.removeClass("mo2f-active")):(o.addClass("hidden"),s.removeClass("hidden"),t.removeClass("mo2f-active"),r.addClass("mo2f-active"))}function validate_selector(e){let o=!1;return/^#/.test(e)&&(o=!0),/^\./.test(e)&&(o=!0),/^input\[name=/.test(e)&&(o=!0),o}function registerwithminiOrange(){jQuery("#my_account_2fa").click()}function validate_url(e){var o=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");if(e.includes(",")){let s=e.split(",");return s.forEach(((e,s,t)=>{o.test(e)?t[s]="true":t[s]="false"})),!s.includes("false")}return!!o.test(e)}function mo2fShowLoader(){jQuery("#mo2f_2fa_popup_dashboard").html("<span class='mo2f_loader' id='mo2f_loader'></span>"),jQuery("#mo2f_2fa_popup_dashboard").css("display","block")}function mo2fCloseLoader(){jQuery("#mo2f_2fa_popup_dashboard").css("display","none")}jQuery(document).ready((function(){function e(){$("#mo2f_method_email").is(":checked")?($("#mo2fa_emailDiv").show(),$("#mo2fa_phoneDiv").hide()):$("#mo2f_method_phone").is(":checked")&&($("#mo2fa_phoneDiv").show(),$("#mo2fa_emailDiv").hide())}switchTab(localStorage.getItem("activeTab")||"mo2f_login_btn"),jQuery("#mo2f_login_btn").click((function(){switchTab("mo2f_login_btn")})),jQuery("#mo2f_register_button").click((function(){switchTab("mo2f_register_button")})),e(),$('input[name="mo2f_auth_method"]').on("change",(function(){e()}));let o=jQuery,s=forms.formArray;is_registered=forms.isRegistered,o("#mo2f_method_phone").is(":checked")?(o("#mo2fa_phoneDiv").css("display","inherit"),o("#mo2fa_emailDiv").css("display","none")):(o("#mo2fa_phoneDiv").css("display","none"),o("#mo2fa_emailDiv").css("display","inherit")),is_registered||(o("#mo2fa_use_shortcode_config").prop("checked",!1),o("#mo2fa_use_shortcode_config").prop("disabled",!0)),jQuery("#regFormList").change((function(){let e=o("#regFormList").prop("selectedIndex");e>o("#regFormList option").length-1?o("#mo2fa_selector_div").css("display","none"):(o("#mo2f_shortcode_email_selector").prop("disabled",!1),o("#mo2f_shortcode_form_selector").prop("disabled",!1),o("#mo2f_shortcode_phone_selector").prop("disabled",!1),o("#mo2f_shortcode_submit_selector").prop("disabled",!1),o("#mo2fa_selector_div").css("display","inherit")),o("#mo2f_shortcode_form_selector").val(s[e].formSelector),o("#mo2f_shortcode_submit_selector").val(s[e].submitSelector),o("#mo2f_shortcode_email_selector").val(s[e].emailSelector),o("#mo2f_shortcode_phone_selector").val(""),$("#mo2f_method_phone").is(":checked")&&(o("#mo2fa_phoneDiv").css("display","inherit"),o("#mo2f_shortcode_phone_selector").attr("placeholder","example #phone_field_id"))})),o("#mo2f_form_config_save").click((function(e){if(e.preventDefault(),is_registered){let e,s,t,r,a;if(a=o("#mo2f_form_submit_after_validation").is(":checked"),r=o("#mo2fa_use_shortcode_config").is(":checked"),e=o("#mo2f_method_phone").is(":checked"),s=o("#mo2f_method_email").is(":checked"),email_selector=o("#mo2f_shortcode_email_selector").val(),phone_selector=o("#mo2f_shortcode_phone_selector").val(),form_selector=o("#mo2f_shortcode_form_selector").val(),submit_selector=o("#mo2f_shortcode_submit_selector").val(),reg_form_name=o("#regFormList").val(),t=!0===s?forms.authTypeEmail:forms.authTypePhone,error="",t===forms.authTypeEmail?""===email_selector?error="Add email selector to use OTP Over Email":validate_selector(email_selector)&&validate_selector(form_selector)&&validate_selector(submit_selector)||(error="ERROR: Invalid Selector(s) detected."):t===forms.authTypePhone&&(""===phone_selector?error="Add phone selector to use Phone Verification":validate_selector(phone_selector)&&validate_selector(form_selector)&&validate_selector(submit_selector)||(error="ERROR: Invalid Selector(s) detected.")),""!=error)error_msg(error);else{mo2fShowLoader();let e={action:"mo2f_login_settings_ajax",option:"mo2f_save_custom_registration_form_settings",nonce:forms.nonce,submit_selector:submit_selector,form_selector:form_selector,email_selector:email_selector,phone_selector:phone_selector,authType:t,customForm:false,formSubmit:a,enableShortcode:r,regFormList:reg_form_name};jQuery.post(ajaxurl,e,(function(e){mo2fCloseLoader(),e.success?success_msg(e.data):error_msg(e.data)}))}}else error_msg("Please Register/Login with miniOrange")})),jQuery("#mo2fa_use_shortcode_config").click((function(){var e={action:"mo2f_login_settings_ajax",option:"mo2f_custom_registration_form",nonce:forms.nonce,mo2f_enable_shortcodes:jQuery("#mo2fa_use_shortcode_config").is(":checked")};jQuery.post(ajaxurl,e,(function(e){e.success?success_msg(e.data):error_msg(e.data)}))}))})),jQuery(document).ready((function(e){jQuery("#mo2f_custom_login_form_config_save").click((function(){let e,o,s,t,r,a;if(e=jQuery("#mo2f_login_url_selector").val(),o=jQuery("#mo2f_login_email_selector").val(),s=jQuery("#mo2f_login_password_selector").val(),passLabel=jQuery("#mo2f_login_password_label").val(),t=jQuery("#mo2f_login_submit_selector").val(),a=jQuery("#mo2f_login_form_selector").val(),r="",""!==o&&""!==s&&""!==t&&""!==e||(r="Please enter all field selectors."),validate_url(e)||""==e||(r="Please enter correct login form url."),validate_selector(o)&&validate_selector(s)&&validate_selector(t)&&(""==a||validate_selector(a))&&(""==passLabel||validate_selector(passLabel))||(r="NOTE: Choosing your Selector: Element's ID Selector looks like #element_id and Element's name Selector looks like input[name=element_name]"),""!=r)error_msg(r);else{mo2fShowLoader();let r={action:"mo2f_login_settings_ajax",option:"mo2f_save_login_form_settings",nonce:forms.nonce,submit_selector:t,email_selector:o,pass_selector:s,url:e,form_selector:a,passlabelSelector:passLabel};jQuery.post(ajaxurl,r,(function(e){mo2fCloseLoader(),e.success?success_msg(e.data):error_msg(e.data)}))}})),jQuery("#mo2f_enable_login_form").click((function(){var e={action:"mo2f_login_settings_ajax",option:"mo2f_enable_disable_login_form",nonce:forms.nonce,login_form_enabled:jQuery("#mo2f_enable_login_form").is(":checked")};jQuery.post(ajaxurl,e,(function(e){e.success?success_msg(e.data):error_msg(e.data)}))}))}));